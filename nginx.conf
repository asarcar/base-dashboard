# services/frontend/dashboard/nginx.conf
# Nginx configuration for a Single Page Application (SPA) with History API Fallback

# Define the number of worker processes. Typically 1 per CPU core.
worker_processes 1;

# Error logging for debugging. Change 'warn' to 'error' or 'crit' for production.
error_log /var/log/nginx/error.log warn;

# Event block defines how Nginx handles connections.
events {
  worker_connections 1024; # Max simultaneous connections per worker.
}

# HTTP block contains server-wide settings.
http {
  # Include common MIME types for serving various file types.
  include /etc/nginx/mime.types;
  default_type application/octet-stream; # Default MIME type if not found.

  # Enable efficient file transfers.
  sendfile on;
  tcp_nopush on; # Optimizes sending of response headers.
  tcp_nodelay on; # Optimizes sending of small packets.

  # Timeout for keep-alive connections.
  keepalive_timeout 65;
  types_hash_max_size 2048; # Adjust if you have many custom MIME types.

  # Gzip compression settings for faster delivery of content.
  gzip on;
  gzip_vary on;
  gzip_proxied any;
  gzip_comp_level 6;
  gzip_buffers 16 8k;
  gzip_http_version 1.1;
  gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

  # Include all server blocks from the conf.d directory.
  include /etc/nginx/conf.d/*.conf;
}
