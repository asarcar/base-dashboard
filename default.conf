# services/frontend/dashboard/default.conf
# Define the server block for your application.
server {
  listen 3080; # Nginx will listen on port 3080 inside the container.
  server_name localhost; # Domain name for the server.

  # Set the root directory for serving static files.
  # This matches where Bazel's pkg_tar rule places your dist/ content.
  root /usr/share/nginx/html;

  # Define default files to serve when a directory is requested.
  index index.html index.htm;

  # CRITICAL: History API Fallback for Single Page Applications (SPAs).
  # This directive tries to find the requested URI as a file ($uri),
  # then as a directory ($uri/), and if neither is found, it falls back
  # to serving the index.html file. This allows client-side routing to work.
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Optional: If you have specific API routes that Nginx should proxy.
  # This is an example, you would configure it based on your backend.
  # location /api/ {
  #     proxy_pass http://your_backend_service:8080;
  #     proxy_http_version 1.1;
  #     proxy_set_header Upgrade $http_upgrade;
  #     proxy_set_header Connection 'upgrade';
  #     proxy_set_header Host $host;
  #     proxy_cache_bypass $http_upgrade;
  # }
}
